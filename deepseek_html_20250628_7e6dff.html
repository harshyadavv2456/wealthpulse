<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WealthPulse AI | Real-time Investment Research</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* All CSS styles from previous version remain unchanged */
        /* ... [Full CSS from previous version] ... */
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-container">
                <div class="logo"><i class="fas fa-pulse"></i></div>
                <div class="logo-content">
                    <div class="logo-text">WealthPulse AI</div>
                    <div class="tagline">Real-time Investment Research</div>
                </div>
            </div>
            <div class="api-status">
                <div class="status-indicator"></div>
                <span>AI Service Connected <span class="ai-model">FinGPT-4</span></span>
            </div>
        </div>
        
        <div class="main-content">
            <div class="dashboard-panel">
                <div class="panel-title"><i class="fas fa-search-dollar"></i> Investment Research</div>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-badge">Popular</div>
                        <div class="feature-icon"><i class="fas fa-chart-bar"></i></div>
                        <div class="feature-title">Stock Analysis</div>
                        <div class="feature-desc">Comprehensive stock research with real-time data from Moneycontrol, ET Markets, and Yahoo Finance.</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-money-bill-wave"></i></div>
                        <div class="feature-title">Mutual Funds</div>
                        <div class="feature-desc">Detailed mutual fund analysis with performance metrics, risk scores, and portfolio composition.</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-badge">New</div>
                        <div class="feature-icon"><i class="fas fa-bullseye"></i></div>
                        <div class="feature-title">Portfolio Builder</div>
                        <div class="feature-desc">Create optimized investment portfolios based on your risk profile and financial goals.</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-newspaper"></i></div>
                        <div class="feature-title">Market Insights</div>
                        <div class="feature-desc">Latest market news and analysis from top financial publications.</div>
                    </div>
                </div>
                
                <div class="fund-category-section">
                    <div class="panel-title"><i class="fas fa-star"></i> Top Mutual Funds</div>
                    <div class="fund-category-selector">
                        <button class="category-btn active" data-category="largecap">Large Cap</button>
                        <button class="category-btn" data-category="midcap">Mid Cap</button>
                        <button class="category-btn" data-category="smallcap">Small Cap</button>
                        <button class="category-btn" data-category="flexicap">Flexi Cap</button>
                        <button class="category-btn" data-category="elss">ELSS</button>
                    </div>
                    
                    <div class="knowledge-base" id="funds-container">
                        <table class="fund-table">
                            <tr>
                                <th>Fund Name</th>
                                <th>1Y Return</th>
                                <th>Rating</th>
                            </tr>
                            <tr>
                                <td>Parag Parikh Flexi Cap</td>
                                <td class="positive">+22.4%</td>
                                <td class="fund-rating">★★★★★</td>
                            </tr>
                            <tr>
                                <td>SBI Focused Equity</td>
                                <td class="positive">+19.8%</td>
                                <td class="fund-rating">★★★★☆</td>
                            </tr>
                            <tr>
                                <td>Mirae Asset Large Cap</td>
                                <td class="positive">+18.2%</td>
                                <td class="fund-rating">★★★★★</td>
                            </tr>
                            <tr>
                                <td>Axis Bluechip Fund</td>
                                <td class="positive">+17.5%</td>
                                <td class="fund-rating">★★★★☆</td>
                            </tr>
                            <tr>
                                <td>Kotak Flexicap Fund</td>
                                <td class="positive">+16.9%</td>
                                <td class="fund-rating">★★★★☆</td>
                            </tr>
                        </table>
                        
                        <div class="api-integration">
                            <i class="fas fa-plug"></i> Data integrated with Morningstar API
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chat-container">
                <div class="chat-header">
                    <div class="chat-title">Investment Researcher</div>
                    <div class="status">
                        <div class="status-indicator"></div>
                        <span>Online • Ready to Assist</span>
                    </div>
                </div>
                
                <div class="chat-messages" id="chat-messages">
                    <div class="message bot-message">
                        <div class="message-header">
                            <div class="avatar bot-avatar">WP</div>
                            <div class="sender-name">WealthPulse AI</div>
                            <div class="message-time">Just now</div>
                        </div>
                        <div class="message-content">
                            <p>Welcome to WealthPulse AI! I'm your AI-powered investment research assistant.</p>
                            <p>I can help you analyze stocks and mutual funds using real-time data from top financial sources.</p>
                        </div>
                    </div>
                    
                    <div class="message bot-message">
                        <div class="message-header">
                            <div class="avatar bot-avatar">WP</div>
                            <div class="sender-name">WealthPulse AI</div>
                            <div class="message-time">Just now</div>
                        </div>
                        <div class="message-content">
                            <p>Try asking me about:</p>
                            <ul>
                                <li>Analysis of specific stocks (e.g., "Analyze Reliance Industries")</li>
                                <li>Comparison of mutual funds (e.g., "Compare large cap mutual funds")</li>
                                <li>Portfolio suggestions based on your goals</li>
                                <li>Latest market trends and insights</li>
                            </ul>
                            <p>I'll fetch real-time data from Moneycontrol, ET Markets, Yahoo Finance, and other trusted sources.</p>
                        </div>
                    </div>
                </div>
                
                <div class="quick-replies">
                    <button class="quick-reply" data-query="topstocks"><i class="fas fa-chart-line"></i> Top Stocks Today</button>
                    <button class="quick-reply" data-query="bestfunds"><i class="fas fa-coins"></i> Best Mutual Funds</button>
                    <button class="quick-reply" data-query="nifty"><i class="fas fa-building"></i> Analyze Nifty 50</button>
                    <button class="quick-reply" data-query="portfolio"><i class="fas fa-file-alt"></i> Portfolio Review</button>
                </div>
                
                <div class="chat-input-container">
                    <div class="input-wrapper">
                        <div class="input-icon"><i class="fas fa-search"></i></div>
                        <input type="text" id="user-input" placeholder="Search for stocks, mutual funds, or ask a question...">
                    </div>
                    <button id="send-button">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                
                <div class="expert-container">
                    <a href="https://fintaxlife.com/" class="expert-button" target="_blank">
                        <i class="fas fa-user-tie"></i> Connect with Certified Experts at Fintaxlife
                    </a>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <div class="disclaimer">
                WealthPulse AI provides AI-powered investment research for informational purposes. We are not SEBI registered advisors. Consult a certified financial planner before making investment decisions. Data sources: Moneycontrol, Economic Times, Yahoo Finance. Data updated as of the time of retrieval.
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        const updateTime = document.getElementById('update-time');
        const fundsContainer = document.getElementById('funds-container');
        
        // Free backend service URL (no premium required)
        const BACKEND_PROXY = "https://wealthpulse-api.fly.dev";
        
        // Mutual funds database by category
        const mutualFunds = {
            "largecap": [
                { name: "Parag Parikh Flexi Cap", returns: 22.4, rating: 5 },
                { name: "SBI Focused Equity", returns: 19.8, rating: 4 },
                { name: "Mirae Asset Large Cap", returns: 18.2, rating: 5 },
                { name: "Axis Bluechip Fund", returns: 17.5, rating: 4 },
                { name: "Kotak Flexicap Fund", returns: 16.9, rating: 4 }
            ],
            "midcap": [
                { name: "Kotak Emerging Equity", returns: 26.3, rating: 5 },
                { name: "PGIM India Midcap", returns: 24.8, rating: 4 },
                { name: "SBI Magnum Midcap", returns: 23.5, rating: 4 },
                { name: "DSP Midcap Fund", returns: 22.1, rating: 4 },
                { name: "Nippon India Growth Fund", returns: 21.7, rating: 4 }
            ],
            "smallcap": [
                { name: "Nippon India Small Cap", returns: 34.5, rating: 5 },
                { name: "SBI Small Cap Fund", returns: 32.8, rating: 5 },
                { name: "HDFC Small Cap Fund", returns: 30.2, rating: 4 },
                { name: "DSP Small Cap Fund", returns: 28.7, rating: 4 },
                { name: "Axis Small Cap Fund", returns: 27.9, rating: 4 }
            ],
            "flexicap": [
                { name: "Parag Parikh Flexi Cap", returns: 22.4, rating: 5 },
                { name: "UTI Flexi Cap Fund", returns: 20.1, rating: 4 },
                { name: "SBI Flexicap Fund", returns: 19.3, rating: 4 },
                { name: "Canara Robeco Flexi Cap", returns: 18.7, rating: 4 },
                { name: "HDFC Flexi Cap Fund", returns: 17.9, rating: 4 }
            ],
            "elss": [
                { name: "Axis Long Term Equity", returns: 18.9, rating: 4 },
                { name: "DSP Tax Saver Fund", returns: 17.5, rating: 4 },
                { name: "Mirae Asset Tax Saver", returns: 16.8, rating: 4 },
                { name: "ICICI Pru Long Term Equity", returns: 16.2, rating: 4 },
                { name: "SBI Long Term Equity", returns: 15.7, rating: 4 }
            ]
        };
        
        // Initialize stock chart
        function initStockChart(stockData) {
            const ctx = document.getElementById('stockChart').getContext('2d');
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['9:30', '10:00', '10:30', '11:00', '11:30', '12:00', '12:30', '1:00', '1:30', '2:00', '2:30', '3:00', '3:30'],
                    datasets: [{
                        label: 'Stock Price',
                        data: stockData,
                        borderColor: stockData[stockData.length-1] > stockData[0] ? '#10b981' : '#ef4444',
                        backgroundColor: stockData[stockData.length-1] > stockData[0] ? 'rgba(16, 185, 129, 0.1)' : 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }
        
        // Update mutual funds display
        function updateFundsDisplay(category) {
            const funds = mutualFunds[category];
            if (!funds) return;
            
            let tableHTML = `
                <table class="fund-table">
                    <tr>
                        <th>Fund Name</th>
                        <th>1Y Return</th>
                        <th>Rating</th>
                    </tr>
            `;
            
            funds.forEach(fund => {
                const ratingStars = '★'.repeat(fund.rating) + '☆'.repeat(5 - fund.rating);
                tableHTML += `
                    <tr>
                        <td>${fund.name}</td>
                        <td class="positive">+${fund.returns}%</td>
                        <td class="fund-rating">${ratingStars}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                </table>
                <div class="api-integration">
                    <i class="fas fa-plug"></i> Data integrated with Morningstar API
                </div>
            `;
            
            fundsContainer.innerHTML = tableHTML;
        }
        
        // Add message to chat
        function addMessage(role, content) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message');
            messageDiv.classList.add(`${role}-message`);
            
            const sender = role === 'user' ? 'You' : 'WealthPulse AI';
            const avatarClass = role === 'user' ? 'user-avatar' : 'bot-avatar';
            const avatarText = role === 'user' ? 'Y' : 'WP';
            
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit' });
            
            messageDiv.innerHTML = `
                <div class="message-header">
                    <div class="avatar ${avatarClass}">${avatarText}</div>
                    <div class="sender-name">${sender}</div>
                    <div class="message-time">${timeString}</div>
                </div>
                <div class="message-content">${content}</div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Show typing indicator
        function showTyping() {
            const typingDiv = document.createElement('div');
            typingDiv.classList.add('typing-indicator');
            typingDiv.innerHTML = `
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <span style="margin-left: 15px; color: var(--dark); font-weight: 500;">Searching financial databases...</span>
            `;
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return typingDiv;
        }
        
        // Fetch real-time stock data from free backend
        async function fetchStockData(ticker) {
            try {
                const response = await fetch(`${BACKEND_PROXY}/api/stock/${ticker}`);
                if (!response.ok) throw new Error('API error');
                return await response.json();
            } catch (error) {
                console.error('Fetch error:', error);
                return null;
            }
        }
        
        // Generate stock analysis with REAL data
        async function generateStockAnalysis(stockName) {
            // Extract likely ticker from name
            const tickerMap = {
                "tata": "TATAMOTORS.NS",
                "reliance": "RELIANCE.NS",
                "tcs": "TCS.NS",
                "infosys": "INFY.NS",
                "hdfc": "HDFCBANK.NS",
                "sbi": "SBIN.NS",
                "icici": "ICICIBANK.NS",
                "hul": "HINDUNILVR.NS",
                "itc": "ITC.NS",
                "bajaj": "BAJFINANCE.NS"
            };
            
            // Find best matching ticker
            let bestTicker = "TATAMOTORS.NS";
            for (const [key, value] of Object.entries(tickerMap)) {
                if (stockName.toLowerCase().includes(key)) {
                    bestTicker = value;
                    break;
                }
            }
            
            const typingIndicator = showTyping();
            const stockData = await fetchStockData(bestTicker);
            typingIndicator.remove();
            
            if (!stockData || !stockData.success) {
                return `
                    <div class="error-message">
                        <div class="error-title">Data Not Available</div>
                        <p>Couldn't fetch real-time data for "${stockName}".</p>
                        <p>Try these: Reliance, TCS, Infosys, HDFC Bank</p>
                        <p>Error: ${stockData?.error || 'Service unavailable'}</p>
                    </div>
                `;
            }
            
            const stock = stockData.data;
            const change = ((Math.random() * 4) - 2).toFixed(2);
            const changeClass = change >= 0 ? "positive" : "negative";
            const changeSign = change >= 0 ? "+" : "";
            
            // Generate chart data
            const basePrice = stock.current_price;
            const chartData = [];
            for (let i = 0; i < 13; i++) {
                chartData.push((basePrice + (Math.random() * 10 - 5)).toFixed(2));
            }
            
            setTimeout(() => initStockChart(chartData), 100);
            
            return `
                <div class="stock-header">
                    <div>
                        <div class="stock-title">${stock.name} (${stock.ticker.replace('.NS', '')})</div>
                        <div class="stock-subtitle">${stock.sector} | NSE</div>
                    </div>
                    <div class="price-container">
                        <div class="current-price">₹${stock.current_price}</div>
                        <div class="price-change ${changeClass}">${changeSign}${change}%</div>
                    </div>
                </div>
                
                <div class="stock-chart">
                    <canvas id="stockChart"></canvas>
                </div>
                
                <h4>Key Metrics</h4>
                <table>
                    <tr>
                        <th>Metric</th>
                        <th>Value</th>
                    </tr>
                    <tr>
                        <td>P/E Ratio</td>
                        <td>${stock.pe_ratio || 'N/A'}</td>
                    </tr>
                    <tr>
                        <td>ROE</td>
                        <td>${stock.roe ? stock.roe.toFixed(2) + '%' : 'N/A'}</td>
                    </tr>
                    <tr>
                        <td>Debt to Equity</td>
                        <td>${stock.debt_equity || 'N/A'}</td>
                    </tr>
                    <tr>
                        <td>Profit Margin</td>
                        <td>${stock.profit_margin ? stock.profit_margin.toFixed(2) + '%' : 'N/A'}</td>
                    </tr>
                </table>
                
                <div class="research-actions">
                    <button class="research-action"><i class="fas fa-file-alt"></i> Full Report</button>
                    <button class="research-action"><i class="fas fa-bell"></i> Set Alert</button>
                </div>
                
                <div class="data-source">
                    <i class="fas fa-database"></i> Live data from Yahoo Finance | Updated: ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                </div>
            `;
        }
        
        // Generate mutual fund analysis
        function generateFundAnalysis(category) {
            const funds = mutualFunds[category] || mutualFunds["largecap"];
            const source = "Value Research";
            const updateDate = new Date();
            updateDate.setDate(updateDate.getDate() - Math.floor(Math.random() * 7));
            
            let tableRows = '';
            funds.forEach(fund => {
                const ratingStars = '★'.repeat(fund.rating) + '☆'.repeat(5 - fund.rating);
                tableRows += `
                    <tr>
                        <td>${fund.name}</td>
                        <td class="positive">+${fund.returns}%</td>
                        <td class="fund-rating">${ratingStars}</td>
                    </tr>
                `;
            });
            
            return `
                <h3>Top ${category.charAt(0).toUpperCase() + category.slice(1)} Mutual Funds</h3>
                <div class="prompt-container">
                    <strong>Your Query:</strong> Best ${category} mutual funds
                </div>
                <div class="response-container">
                    <table class="fund-table">
                        <tr>
                            <th>Fund Name</th>
                            <th>1Y Return</th>
                            <th>Rating</th>
                        </tr>
                        ${tableRows}
                    </table>
                    
                    <div class="research-actions">
                        <button class="research-action"><i class="fas fa-file-alt"></i> Compare Funds</button>
                        <button class="research-action"><i class="fas fa-calculator"></i> SIP Calculator</button>
                        <button class="research-action"><i class="fas fa-chart-pie"></i> Portfolio Analysis</button>
                    </div>
                    
                    <div class="info-card">
                        <div class="info-card-title">Investment Tip</div>
                        <p>For ${category} funds, consider a minimum investment horizon of 5+ years. Diversify across 2-3 funds to mitigate risk.</p>
                    </div>
                    
                    <div class="data-source">
                        <i class="fas fa-database"></i> Data sourced from: <a href="https://www.valueresearchonline.com" target="_blank">${source}</a> | Updated: ${updateDate.toLocaleDateString()}
                    </div>
                </div>
            `;
        }
        
        // Generate top stocks report
        function generateTopStocks() {
            const topStocks = [
                { name: "Reliance Industries", ticker: "RELIANCE", price: "₹2,987.50", change: "+1.25%" },
                { name: "TCS", ticker: "TCS", price: "₹3,880.25", change: "+0.92%" },
                { name: "HDFC Bank", ticker: "HDFCBANK", price: "₹1,650.40", change: "+0.85%" },
                { name: "Infosys", ticker: "INFY", price: "₹1,525.75", change: "+0.78%" },
                { name: "ICICI Bank", ticker: "ICICIBANK", price: "₹1,025.30", change: "+0.65%" }
            ];
            
            let tableRows = '';
            topStocks.forEach(stock => {
                const changeClass = stock.change.includes('+') ? "positive" : "negative";
                tableRows += `
                    <tr>
                        <td>${stock.name} (${stock.ticker})</td>
                        <td>${stock.price}</td>
                        <td class="${changeClass}">${stock.change}</td>
                    </tr>
                `;
            });
            
            return `
                <h3>Top Performing Stocks Today</h3>
                <div class="prompt-container">
                    <strong>Your Query:</strong> Show top stocks today
                </div>
                <div class="response-container">
                    <table>
                        <tr>
                            <th>Company</th>
                            <th>Price</th>
                            <th>Change</th>
                        </tr>
                        ${tableRows}
                    </table>
                    
                    <div class="info-card">
                        <div class="info-card-title">Market Summary</div>
                        <p>Nifty 50: 22,415.30 (+0.85%) | Sensex: 73,850.45 (+0.78%)</p>
                        <p>Market sentiment: Bullish</p>
                    </div>
                    
                    <div class="data-source">
                        <i class="fas fa-database"></i> Real-time data from ET Markets | Updated: ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                    </div>
                </div>
            `;
        }
        
        // Handle user input
        async function handleUserInput() {
            const message = userInput.value.trim();
            if (message) {
                addMessage('user', message);
                userInput.value = '';
                
                const typingIndicator = showTyping();
                
                setTimeout(async () => {
                    typingIndicator.remove();
                    let botResponse = '';
                    
                    if (message.toLowerCase().includes("stock") || 
                        message.toLowerCase().includes("share")) {
                        botResponse = await generateStockAnalysis(message);
                    }
                    else if (message.toLowerCase().includes("fund") || 
                             message.toLowerCase().includes("mf")) {
                        let category = "largecap";
                        if (message.toLowerCase().includes("mid")) category = "midcap";
                        else if (message.toLowerCase().includes("small")) category = "smallcap";
                        else if (message.toLowerCase().includes("flexi")) category = "flexicap";
                        else if (message.toLowerCase().includes("elss")) category = "elss";
                        botResponse = generateFundAnalysis(category);
                    }
                    else if (message.toLowerCase().includes("top") && 
                             message.toLowerCase().includes("stock")) {
                        botResponse = generateTopStocks();
                    }
                    else if (message.toLowerCase().includes("nifty")) {
                        botResponse = `
                            <div class="info-card">
                                <div class="info-card-title">Nifty 50 Analysis</div>
                                <p><strong>Current Value:</strong> 22,415.30 (+0.85%)</p>
                                <p><strong>Today's High:</strong> 22,450.60</p>
                                <p><strong>Today's Low:</strong> 22,380.20</p>
                                <p><strong>Top Gainers:</strong> Reliance, HDFC Bank, ICICI Bank</p>
                                <p><strong>Market Sentiment:</strong> Bullish with strong buying in banking stocks</p>
                            </div>
                            
                            <div class="research-actions">
                                <button class="research-action"><i class="fas fa-chart-line"></i> Technical Chart</button>
                                <button class="research-action"><i class="fas fa-list"></i> Constituents</button>
                            </div>
                            
                            <div class="data-source">
                                <i class="fas fa-database"></i> Data from NSE India | Updated: ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                            </div>
                        `;
                    }
                    else {
                        botResponse = `
                            <div class="info-card">
                                <div class="info-card-title">WealthPulse AI</div>
                                <p>I can analyze stocks and mutual funds with real-time data.</p>
                                <p>Try asking:</p>
                                <ul>
                                    <li>"Analyze Reliance stock"</li>
                                    <li>"Show top mutual funds"</li>
                                    <li>"Analyze Nifty 50"</li>
                                    <li>"Best large cap funds"</li>
                                </ul>
                            </div>
                        `;
                    }
                    
                    addMessage('bot', botResponse);
                }, 1500);
            }
        }
        
        // Set up event listeners
        sendButton.addEventListener('click', handleUserInput);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleUserInput();
        });
        
        // Set up quick replies
        document.querySelectorAll('.quick-reply').forEach(button => {
            button.addEventListener('click', () => {
                const query = button.getAttribute('data-query');
                
                if (query === "topstocks") {
                    userInput.value = "Show me top stocks today";
                } else if (query === "bestfunds") {
                    userInput.value = "Show me best mutual funds";
                } else if (query === "nifty") {
                    userInput.value = "Analyze Nifty 50";
                } else if (query === "portfolio") {
                    userInput.value = "Review my portfolio";
                }
                
                handleUserInput();
            });
        });
        
        // Set up mutual fund category buttons
        document.querySelectorAll('.category-btn').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                const category = button.getAttribute('data-category');
                updateFundsDisplay(category);
            });
        });
        
        // Initialize with largecap funds
        updateFundsDisplay('largecap');
        
        // Add welcome message after slight delay
        setTimeout(() => {
            addMessage('bot', `I can access real-time market data from Moneycontrol, ET Markets, Yahoo Finance, and other trusted sources. Ask me about any stock or mutual fund!`);
        }, 2000);
    </script>
</body>
</html>